-- CREATING ALL THE REQUIRED TABLES

CREATE TABLE STUDENT (
	R201951024 INT, 
	ROLLNO INT(5) NOT NULL, 
	NAME VARCHAR(20) NOT NULL, 
	DOB DATE NOT NULL, 
	GENDER CHAR(2), 
	DOA DATE, 
	BCODE INT(3),
	PRIMARY KEY (ROLLNO),
	-- FOREIGN KEY (BCODE) REFERENCES BRANCH (BCODE),
	CONSTRAINT CHK_Gender CHECK (GENDER IN ('M','F'))
);
SELECT * FROM STUDENT;

CREATE TABLE BRANCH (
	BCODE INT, 
	BNAME VARCHAR(25), 
	DNO INT,  
	-- FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO), 
    PRIMARY KEY (BCODE)
);
SELECT * FROM BRANCH;

CREATE TABLE DEPARTMENT ( 
	DNO INT, 
	DNAME VARCHAR(25),
    PRIMARY KEY (DNO)
);
SELECT * FROM DEPARTMENT;

CREATE TABLE COURSE (
	CCODE INT, 
	CNAME VARCHAR(25), 
	CREDITS INT, 
	DNO INT, 
    -- FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO), 
    PRIMARY KEY (CCODE)
);
SELECT * FROM COURSE;

CREATE TABLE BRANCH_COURSE (
	BCODE INT, 
	CCODE INT, 
	SEMESTER INT, 
    -- FOREIGN KEY (BCODE) REFERENCES BRANCH (BCODE), 
    -- FOREIGN KEY (CCODE) REFERENCES COURSE (CCODE), 
    PRIMARY KEY (BCODE, CCODE)
);
SELECT * FROM BRANCH_COURSE;

CREATE TABLE ENROLLS (
	ROLLNO INT, 
	CCODE INT, 
	SESS VARCHAR(15), 
	GRADE CHAR(2),
    -- FOREIGN KEY (ROLLNO) REFERENCES STUDENT (ROLLNO), 
    -- FOREIGN KEY (CCODE) REFERENCES COURSE (CCODE), 
	PRIMARY KEY (ROLLNO, CCODE, SESS), 
    CONSTRAINT CHK_Grade CHECK (GRADE IN (‘S’, ‘A’, ‘B’, ‘C’, ‘D’, ‘E’, ‘U’ ))
);
SELECT * FROM ENROLLS;


-- CONNECTING THE TABLES THROUGH FORIGN KEYS

ALTER TABLE BRANCH 
ADD FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO);


ALTER TABLE BRANCH_COURSE 
ADD FOREIGN KEY (BCODE) REFERENCES BRANCH (BCODE);

ALTER TABLE BRANCH_COURSE 
ADD FOREIGN KEY (CCODE) REFERENCES COURSE (CCODE);


ALTER TABLE STUDENT 
ADD FOREIGN KEY (BCODE) REFERENCES BRANCH (BCODE);


ALTER TABLE COURSE 
ADD FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO);


ALTER TABLE ENROLLS 
ADD FOREIGN KEY (ROLLNO) REFERENCES STUDENT (ROLLNO);

ALTER TABLE ENROLLS 
ADD FOREIGN KEY (CCODE) REFERENCES COURSE (CCODE);


-- INSERT VALUES INTO TABLES
-- DEPARTMENT
INSERT INTO DEPARTMENT VALUE (
	1, 
	"CS"
);
INSERT INTO DEPARTMENT VALUE (
	2, 
	"EC"
);
INSERT INTO DEPARTMENT VALUE (
	3, 
	"MA"
);
INSERT INTO DEPARTMENT VALUE (
	4, 
	"HS"
);
INSERT INTO DEPARTMENT VALUE (
	5, 
	"HS"
);

-- COURSE
INSERT INTO COURSE VALUE (
	1101, 
	"OOPS", 
    2, 
    1
);
INSERT INTO COURSE VALUE (
	1102, 
	"ALGO", 
    3, 
    1
);
INSERT INTO COURSE VALUE (
	1201, 
	"DS", 
    3, 
    1
);
INSERT INTO COURSE VALUE (
	1401, 
	"AB", 
    3, 
    1
);
INSERT INTO COURSE VALUE (
	1402, 
	"ABB", 
    2, 
    1
);
INSERT INTO COURSE VALUE (
	1409, 
	"DJA", 
    4, 
    1
);
INSERT INTO COURSE VALUE (
	1406, 
	"PPL", 
    1, 
    1
);
INSERT INTO COURSE VALUE (
	2101, 
	"CIRCUITS", 
    2, 
    2
);
INSERT INTO COURSE VALUE (
	2103, 
	"BA", 
    2, 
    2
);
INSERT INTO COURSE VALUE (
	2204, 
	"DLD", 
    3, 
    2
);
INSERT INTO COURSE VALUE (
	3102, 
	"ALGEBRA", 
    4, 
    3
);
INSERT INTO COURSE VALUE (
	4201, 
	"WRITING", 
    2, 
    4
);
SELECT * FROM COURSE;

-- BRANCH
INSERT INTO BRANCH VALUE (
	101, 
	"CSE", 
    1
);
INSERT INTO BRANCH VALUE (
	102, 
	"IT", 
    1
);
INSERT INTO BRANCH VALUE (
	103, 
	"AI", 
    1
);
INSERT INTO BRANCH VALUE (
	104, 
	"WEB", 
    1
);
INSERT INTO BRANCH VALUE (
	201, 
	"B.A", 
    4
);
SELECT * FROM BRANCH;

-- STUDENT
INSERT INTO STUDENT VALUE (
	NULL, 
    1024, 
	"ANIRUDH", 
    STR_TO_DATE("FEBRUARY 18 2002", "%M %d %Y"), 
    "M", 
    STR_TO_DATE("MARCH 10 2019", "%M %d %Y"), 
    101
);
INSERT INTO STUDENT VALUE (
	NULL, 
    1018, 
	"AMAN", 
    STR_TO_DATE("JUNE 29 2002", "%M %d %Y"), 
    "M", 
    STR_TO_DATE("MARCH 10 2019", "%M %d %Y"), 
    201
);
INSERT INTO STUDENT VALUE (
	NULL, 
    1177, 
	"YASH", 
    STR_TO_DATE("JULY 05 2001", "%M %d %Y"), 
    "M", 
    STR_TO_DATE("MARCH 10 2019", "%M %d %Y"), 
    101
);
SELECT * FROM STUDENT;

-- BRANCH_COURSE
INSERT INTO BRANCH_COURSE VALUE (
	101, 
	1101, 
    1
);
INSERT INTO BRANCH_COURSE VALUE (
	101, 
	1201, 
    2
);
INSERT INTO BRANCH_COURSE VALUE (
	101, 
	1102, 
    2
);
INSERT INTO BRANCH_COURSE VALUE (
	201, 
	1102, 
    2
);
SELECT * FROM BRANCH_COURSE;

-- ENROLL STUDNETS IN COURSES
INSERT INTO ENROLLS VALUE (
	1024, 
	1101, 
    STR_TO_DATE("APRIL 01 2020", "%M %d %Y"), 
    "A"
);
INSERT INTO ENROLLS VALUE (
	1018, 
	1102, 
    STR_TO_DATE("APRIL 01 2020", "%M %d %Y"), 
    "B"
);
INSERT INTO ENROLLS VALUE (
	1177, 
	2101, 
    STR_TO_DATE("APRIL 01 2020", "%M %d %Y"), 
    "S"
);
INSERT INTO ENROLLS VALUE (
	1024, 
	1409, 
    STR_TO_DATE("APRIL 01 2021", "%M %d %Y"), 
    "S"
);
INSERT INTO ENROLLS VALUE (
	1024, 
	1406, 
    STR_TO_DATE("APRIL 07 2021", "%M %d %Y"), 
    "S"
);
INSERT INTO ENROLLS VALUE (
	1024, 
	1102, 
    STR_TO_DATE("MAY 07 2021", "%M %d %Y"), 
    "S"
);
SELECT * FROM ENROLLS;